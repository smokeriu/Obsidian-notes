# N元语法
当我们面对的序列很长时，将其看做一个整体分析，会导致空间复杂度急剧增加，N元语法借用了[马尔科夫假设](序列模型.md#马尔科夫假设)，使我们当前单词只与前$\tau$个单词相关，即：
$$
\begin{split}\begin{aligned}
P(x_1, x_2, x_3, x_4) &=  P(x_1) P(x_2) P(x_3) P(x_4),\\
P(x_1, x_2, x_3, x_4) &=  P(x_1) P(x_2  \mid  x_1) P(x_3  \mid  x_2) P(x_4  \mid  x_3),\\
P(x_1, x_2, x_3, x_4) &=  P(x_1) P(x_2  \mid  x_1) P(x_3  \mid  x_1, x_2) P(x_4  \mid  x_2, x_3).
\end{aligned}\end{split}
$$
其中，$\tau=0,1,2$，称为一元语法，二元语法和三元语法。
> 其实是$\tau+1$元语法。

以常见的二元语法距离，对于单词对$x_1, x_2, x_3, x_4$，$x_2$出现的概率只与$x_1$有关，$x_3$只与$x_2$有关，$x_4$只与$x_3$有关。

# 随机采样
在随机采样中，每个样本都是在原始的长序列上任意捕获的子序列。 在迭代过程中，来自两个相邻的、随机的、小批量中的子序列不一定在原始序列上相邻。对于语言建模，目标是基于到目前为止我们看到的词元来预测下一个词元， 因此*标签*是移位了一个词元的原始序列。
在随机采样中，我们会得到**长度相等**，但在原始序列中**并不相邻**的N个子序列。

# 顺序分区
除了对原始序列可以随机抽样外， 我们还可以保证两个*相邻的小批量*中的*子序列在原始序列上也是相邻的*。 这种策略在基于小批量的迭代过程中保留了拆分的子序列的顺序，因此称为顺序分区。

