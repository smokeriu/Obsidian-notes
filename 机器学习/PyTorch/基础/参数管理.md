# 参数访问
## 访问所有参数
通过块的`state_dict`方法，可以获取这个块的参数信息。

对于某一层：
```python
net1 = nn.Linear(4, 8)
net1.state_dict()
```

这个方法返回一个OrderedDict，其中：
- `key`为参数名。
- `value`为参数值，为`tensor`类型。 
例如：`('weight', tensor([])), ('bias', tensor([])`。

特别的，某些块没有参数，则将返回一个空的Dict，例如：
```python
net2 = nn.ReLU()
print(net2.state_dict())
```
则会返回一个空的Dict：`OrderedDict()`。

特别的，如果我们对包含多个块的块访问时，例如：
```python
net = nn.Sequential(net1,net2,net3)
net.state_dict()
```

则会将所有层的参数返回，对于Sequential来说，则使用idx作为前缀来区分：`('0.weight', tensor([])), ('2.weight', tensor([]))`。没有参数的块会被跳过，但索引会被保留。

> 其实，在[自定义块](自定义块.md)中

特别的，我们可以通过下标来访问复合块中的某一个块：
```python
net[0] # 即返回net1
```


需要注意，通过state_dict访问时，value是tensor类型，但实际参数是更具体的子类，其实这些参数是从参数`_parameters: Dict[str, Optional[Parameter]]`中获取的，可以从看到定义中，value是`torch.nn.parameter.Parameter`。

## 其他访问所有参数的方式
也因为如此，其实我们可以通过`named_parameters()`方法访问所有参数，与state_dict不同，这个方法返回的是一个元组的迭代器`Iterator[Tuple]`，可以根据场景选择具体的方法：
```python
def named_parameters(...) -> Iterator[Tuple[str, Parameter]]
```

## 访问某一个参数
一般而言，我们可以直接用`state_dict`返回的key来访问某一个参数：
```python
net1.weight
```
因为返回值是一个tensor，所以我们可以进一步访问tensor的内部属性：
```python
net1.weight.grad # 访问梯度
net1.weight.data # 访问具体的张量数据
```

# 参数初始化