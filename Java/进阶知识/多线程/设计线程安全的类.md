设计一个线程安全的类，主要包括如下：
- 找出构成对象状态的所有变量。
- 找出约束状态变量的不变性条件。
- 建立并发访问管理策略。

# 收集同步需求
收集同步需求，一般指的是通过分析类的变量，来判断各种操作是否是线程安全的。

## 变量
一个对象的变量包括了其所有的字段，如果这些字段不是基础类型的，则含包括了内部的字段。并以此不断递归。
不过一般情况下，大部分字段都是集合类，我们自己构建的类，基础类型，某些库提供的类。当库提供的类过于复杂而难以分析时，我们可以将其整个看成非线程安全的。

## 不变性条件
某些变量自身受到其他约束、或对其改变依赖于之前的值（先验条件）、或其改变后的值收到了某些限制（后验条件），这就说明这个变量有不变性条件。对于这类变量进行修改时，需要注意原子性。

## 状态所有权
有时我们需要发布变量，如果需要保证线程安全，则需要参考[[发布与逃逸]]来确保是正确发布的。

# 并发访问策略
## 实例封闭
将所有数据限制在一个实例内部，仅通过有限的方法对外提供服务，这样，所有访问路径都是已知的，就更容易保证线程安全性。
一般而言，会结合加锁策略来保证线程安全性。

> 这个策略下，无论bm'll

### 监视器模式



## 线程安全委托

## 