我们需要一个指标来衡量准确性，但对于序列模型而言，不同长度的序列是难以直接进行比较的，

对于单个结果的预测，可以通过[[../../../../数学/基础/信息论/交叉熵|交叉熵]]的均值来衡量预测的准确性，而对于一个序列，我们取其均值来表示整体的准确性。
$$
\frac{1}{n} \sum_{t=1}^n -\log P(x_t \mid x_{t-1}, \ldots, x_1),
$$
不过，实际使用中，更偏向于使用困惑度：
$$
\exp\left(-\frac{1}{n} \sum_{t=1}^n \log P(x_t \mid x_{t-1}, \ldots, x_1)\right).
$$
可以看到，其是平均交叉熵的自然指数的变形。困惑度的最好的理解是“下一个词元的实际选择数的调和平均数”。

- 最好的qk'k